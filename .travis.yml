language: cpp

addons:
  apt:
    packages:
      - cmake
#      - clang-3.7
      - g++-5
      - gcc-5
    sources:
      - kalakris-cmake
#      - llvm-toolchain-precise
      - ubuntu-toolchain-r-test
      
install:
- sudo apt-get install -qq --reinstall binutils
- sudo apt-get install build-essential
- if [ "$CXX" = "g++" ]; then export CXX="g++-5" CC="gcc-5"; fi
- if [ "$CXX" = "clang++" ]; then export CXX="clang++3.7" CC="clang-3.7"; fi

script:
- $CXX --version
- ./build/build_cpp.sh
- ./build/build_cpp.sh -e test_build
- ./build/build_cpp.sh -e spam_classification
- ./build/build_cpp.sh -e rsa
- ./build/build_cpp.sh -e mersenne_twister
- ./build/build_cpp.sh -e kmeans
- ./build/build_cpp.sh -e sort_test
- ./llama_cpp/benchmark/install_benchmark.sh
- pushd /home/travis/build/Llama-Group/benchmark_llama_cpp/
- sudo make install
- popd
- export CXX="clang++"
- cmake ./llama_cpp/benchmark/google_benchmark
- make
- rm ./libbenchmark.a
- cp -f ./src/libbenchmark.a ./
- sudo rm /usr/local/lib/libbenchmark.a
- sudo cp -f ./src/libbenchmark.a /usr/local/lib/libbenchmark.a
- clang++ -std=c++11 testlib.cpp libbenchmark.a -lpthread
- clang++ -std=c++11 testlib.cpp -lz /usr/local/lib/libbenchmark.a -lpthread
- clang++ -std=c++11 testlib.cpp -L. -lbenchmark -lpthread
- ./build/build_cpp.sh -b sort_benchmark

compiler: g++

sudo: required
