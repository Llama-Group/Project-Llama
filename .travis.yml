language: cpp

addons:
  apt:
    packages:
      - cmake
#      - clang-3.7
      - g++-5
      - gcc-5
    sources:
      - kalakris-cmake
#      - llvm-toolchain-precise
      - ubuntu-toolchain-r-test
      
install:
- sudo apt-get install build-essential
- if [ "$CXX" = "g++" ]; then export CXX="g++-5" CC="gcc-5"; fi
- if [ "$CXX" = "clang++" ]; then export CXX="clang++3.7" CC="clang-3.7"; fi

script:
- g++5 -c l.cpp
- ar rvs libl.a l.o
- rm l.o 
- clang m.cpp libl.a
- clang -L. -ll m.cpp
- g++-5 -std=c++11 -L. -lbenchmark testlib.cpp
- g++-5 -std=c++11 testlib.cpp libbenchmark.a
- g++-5 -L. -ll m.cpp
- g++-5 m.cpp libl.a
- uname -a
- $CXX --version
- ./build/build_cpp.sh
- ./build/build_cpp.sh -e test_build
- ./build/build_cpp.sh -e spam_classification
- ./build/build_cpp.sh -e rsa
- ./build/build_cpp.sh -e mersenne_twister
- ./build/build_cpp.sh -e kmeans
- ./build/build_cpp.sh -e sort_test
- ./llama_cpp/benchmark/install_benchmark.sh
- cp -f ./libbenchmark.a ../benchmark_llama_cpp/src/libbenchmark.a
- pushd /home/travis/build/Llama-Group/benchmark_llama_cpp/
- sudo make install
- popd
- ./build/build_cpp.sh -b sort_benchmark

compiler: g++

sudo: required
